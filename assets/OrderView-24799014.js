import{_ as J,R as L,M as N,r as w,o as l,c as d,a as t,n as _,b as u,w as x,d as c,t as n,F as p,g as b,e as m,m as M,v as V,p as A}from"./index-8201d654.js";import{S as C}from"./sweetalert2.all-f808f091.js";const{VITE_URL:y,VITE_PATH:v}={VITE_PATH:"ssozr",VITE_URL:"https://vue3-course-api.hexschool.io/",BASE_URL:"/vueweek82/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},S={data(){return{paymentOptions:["ATM","信用卡","電信支付"],num:1,cartData:[],dalModal:"",delData:{},delId:"",dataModal:"",dataModalJudge:!1,disabled:!0,addressData:"",address:{city:"",areaName:"",content:"",index:"",areaList:[]},paymentMethod:"",userData:{user:{name:"",email:"",address:"",phone:""},message:""},coupon:{couponJudge:!1,couponNum:""},orderId:"",payModal:""}},components:{RouterLink:L},methods:{nextBtn(){this.num++},preBtn(){this.num--},getCartData(){this.$http.get(`${y}/v2/api/${v}/cart`).then(a=>{this.cartData=a.data.data}).catch(a=>{alert(a.data.message).error(a)})},openDelModal(a){this.deldata={},this.delModal.show(),this.delId=a.id,this.delData=a.product},delCart(){this.$http.delete(`${y}/v2/api/${v}/cart/${this.delId}`).then(a=>{this.delData={},this.delId="",this.delModal.hide(),this.getCartData(),this.dataModal.hide(),C.fire(`${a.data.message}`)}).catch(a=>{alert(a.data.message).error(a)})},changeQty(a,e){this.disabled=!0;const B={product_id:e,qty:a};this.$http.put(`${y}/v2/api/${v}/cart/${e}`,{data:B}).then(f=>{C.fire(`${f.data.message}`),this.disabled=!1,this.dataModal.hide(),this.getCartData()}).catch(f=>{alert(f.data.message).error(f)})},getAddressData(){this.$http.get("https://raw.githubusercontent.com/donma/TaiwanAddressCityAreaRoadChineseEnglishJSON/master/AllData.json").then(a=>{this.addressData=a.data}).catch(a=>{alert(a.data.message).error(a)})},disabledBtn(){this.disabled=!1},city(){this.address.areaName="";const a=this.addressData.findIndex(e=>e.CityName===this.address.city);this.address.index=a,this.address.areaList={...this.addressData[a].AreaList}},isPhone(a){return/^(09)[0-9]{8}$/.test(a)?!0:"需要正確的電話號碼"},couponBtn(){const a={code:this.coupon.couponNum};this.$http.post(`${y}/v2/api/${v}/coupon`,{data:a}).then(e=>{this.coupon.couponJudge=e.data.success,C.fire(`${e.data.message}`)}).catch(e=>{alert(e.data.message).error(e)})},couponBtnDel(){this.coupon.couponJudge=!1},onSubmit(){this.userData.user.address=`${this.address.city}${this.address.areaName}${this.address.content}`;const a={user:{name:this.userData.user.name,email:this.userData.user.email,tel:this.userData.user.phone,address:this.userData.user.address},message:this.userData.message};this.$http.post(`${y}/v2/api/${v}/order`,{data:a}).then(e=>{this.orderId=e.data.orderId,this.payModal.show()}).catch(e=>{alert(e.data.message).error(e)})},pay(){this.$http.post(`${y}/v2/api/${v}/pay/${this.orderId}`).then(a=>{this.payModal.hide(),C.fire(`${a.data.message}`),this.num++}).catch(a=>{alert(a.data.message).error(a)})},openDataModal(a){this.dataModalJudge=!0,this.productData={...a},this.delId=a.id,this.dataModal.show()},formatNumber(a){if(a)return a.toLocaleString()}},mounted(){this.getCartData(),this.delModal=new N(this.$refs.delModal),this.getAddressData(),this.payModal=new N(this.$refs.payModal),this.dataModal=new N(this.$refs.dataModal)}},E={class:"container-fuli"},R={class:"row"},q={class:"order-progress pt-4"},j=t("li",{class:"active"},"訂單確認",-1),O={class:"container mb-15"},P={class:"row"},Q={key:0,class:"row"},z=t("h2",{class:"text-center"},"訂單確認",-1),F={class:"row"},H={class:"table align-middle d-lg-table d-none col-12"},W=t("thead",null,[t("tr",{class:"text-center"},[t("th",{scope:"col"},"課程名稱"),t("th",{scope:"col"},"授課老師"),t("th",{scope:"col"},"總課程數"),t("th",{scope:"col"},"購買數量"),t("th",{scope:"col"},"價格"),t("th")])],-1),G={class:"fs-6 mb-0"},K={class:"dropdown"},X={class:"btn btn-secondary dropdown-toggle",type:"button",id:"dropdownMenuButton1","data-bs-toggle":"dropdown","aria-expanded":"false"},Y={class:"dropdown-menu","aria-labelledby":"dropdownMenuButton1"},Z=["onClick"],$=["onClick"],tt={class:"text-center"},et=t("td",null,null,-1),st=t("td",null,null,-1),ot=t("td",null,null,-1),at=t("td",null,null,-1),lt=t("td",null,null,-1),dt={class:"align-bottom"},nt={class:"border-bottom border-primary border-3 mb-0"},it={class:"ms-1"},rt={class:"row d-lg-none my-15"},ct={class:""},ut={class:"fs-5"},mt={class:"d-flex align-items-center justify-content-between"},ht=["onClick"],_t={class:"text-end"},pt={class:"mb-0 fs-4"},bt={class:"ms-1"},yt={class:"modal",tabindex:"-1",ref:"delModal"},vt={class:"modal-dialog"},ft={class:"modal-content"},gt={class:"modal-header"},Dt={key:0,class:"modal-title"},kt=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),Mt=t("div",{class:"modal-body"},[t("p",null,"確定移出購物車?")],-1),wt={class:"modal-footer"},xt=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"取消",-1),Ct={class:"modal",tabindex:"-1",ref:"dataModal"},Nt={class:"modal-dialog"},Vt={key:0,class:"modal-content"},Bt={class:"modal-header"},Tt={class:"modal-title"},At={class:"border-bottom border-3 border-primary"},It=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),Ut={class:"modal-body"},Jt={class:"p-0"},Lt={class:"mb-3"},St={class:"d-flex align-items-center justify-content-between"},Et={class:"d-flex align-items-center justify-content-between"},Rt={class:"dropdown"},qt={class:"btn btn-secondary dropdown-toggle",type:"button",id:"dropdownMenuButton1","data-bs-toggle":"dropdown","aria-expanded":"false"},jt={class:"dropdown-menu","aria-labelledby":"dropdownMenuButton1"},Ot=["onClick"],Pt={class:"modal-footer"},Qt=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"取消",-1),zt={key:1,class:"row col-md-6 offset-md-3"},Ft={class:"mb-3 col-md-6"},Ht={for:"name",class:"form-label"},Wt={key:0,class:"text-danger"},Gt={class:"mb-3 col-md-6"},Kt={for:"email",class:"form-label"},Xt={key:0,class:"text-danger"},Yt={class:"mb-3 col-md-6"},Zt={for:"phone",class:"form-label"},$t={key:0,class:"text-danger"},te={class:"mb-3 col-md-6"},ee={for:"payment",class:"form-label"},se={key:0,class:"text-danger"},oe=t("option",{value:"信用卡"},"信用卡",-1),ae=t("option",{value:"ATM"},"ATM",-1),le=t("option",{value:"電信繳費"},"電信繳費",-1),de=[oe,ae,le],ne={class:"input-group mb-3"},ie={style:{width:"100%"},for:"地址",class:"form-label"},re={key:0,class:"text-danger"},ce={key:0,value:""},ue=["value"],me=["disabled"],he={key:0,value:""},_e=["value"],pe={class:"input-group mb-3"},be=t("span",{class:"input-group-text"},"留言區",-1),ye={class:"col-md-8"},ve=t("label",{for:"coupon",class:"mb-3"},"優惠券:",-1),fe={class:"input-group"},ge=["disabled"],De=["disabled"],ke={key:0},Me={key:1},we={class:"text-end d-flex justify-content-center col-md-4"},xe={class:"d-flex align-items-end"},Ce={key:0,class:"border-bottom border-primary border-3 mb-0 fs-5"},Ne={class:"ms-1"},Ve={key:1,class:"border-bottom border-primary border-3 mb-0 fs-5"},Be={class:"ms-1"},Te={class:"text-center mt-6 btn-list"},Ae=["disabled"],Ie={key:0,class:"row"},Ue=t("h2",{class:"text-center"},"課程購買完成",-1),Je=t("div",{class:"d-flex justify-content-center"},[t("ul",null,[t("li",null,"客服人員將會在三天內與您電話連絡"),t("li",null,"若有任何問題，皆可連絡客服")])],-1),Le={class:"modal",tabindex:"-1",id:"payModal",ref:"payModal"},Se={class:"modal-dialog"},Ee={class:"modal-content"},Re={class:"modal-header"},qe={class:"modal-title"},je=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),Oe=t("div",{class:"modal-body"},[t("h3",null,"資料傳送完成，繼續付款？")],-1),Pe={class:"modal-footer"},Qe=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"取消",-1);function ze(a,e,B,f,o,i){const T=w("RouterLink"),g=w("v-field"),D=w("error-message"),I=w("v-form");return l(),d("div",E,[t("div",R,[t("ul",q,[j,t("li",{class:_({active:o.num>=2})}," 填寫資料",2),t("li",{class:_({active:o.num>=3})},"付款完成",2)])]),t("div",O,[t("div",P,[u(I,{onSubmit:e[18]||(e[18]=r=>i.onSubmit())},{default:x(({errors:r})=>[o.num===1?(l(),d("div",Q,[z,t("div",F,[t("table",H,[W,t("tbody",null,[(l(!0),d(p,null,b(o.cartData.carts,(s,h)=>(l(),d("tr",{key:h,class:"text-center"},[t("td",null,[t("h2",G,n(s.product.title),1)]),t("td",null,n(s.product.unit),1),t("td",null,n(s.product.origin_price*s.qty)+"堂",1),t("td",null,[t("div",K,[t("button",X,n(s.qty),1),t("ul",Y,[(l(),d(p,null,b(20,(k,U)=>t("li",{key:U},[t("a",{onClick:Fe=>i.changeQty(k,s.id),class:"dropdown-item"},n(k),9,Z)])),64))])])]),t("td",null,n(i.formatNumber(s.total)),1),t("td",null,[t("button",{type:"button",class:"btn btn-primary rounded-pill",onClick:k=>i.openDelModal(s)},"刪除",8,$)])]))),128)),t("tr",tt,[et,st,ot,at,lt,t("td",dt,[t("h2",nt,[m("總金額:NT "),t("span",it,n(i.formatNumber(o.cartData.total)),1)])])])])]),t("div",rt,[(l(!0),d(p,null,b(o.cartData.carts,(s,h)=>(l(),d("ul",{key:h,class:"border-bottom pb-3 border-primary"},[t("li",ct,[u(T,{to:`/class/${s.product.id}`},{default:x(()=>[t("h2",ut,n(s.product.title),1)]),_:2},1032,["to"]),t("div",mt,[t("div",null,"課程總價格:"+n(i.formatNumber(s.total)),1),t("button",{type:"button",class:"btn btn-primary",onClick:k=>i.openDataModal(s)},"詳細資料",8,ht)])])]))),128)),t("div",_t,[t("h2",pt,[m(" 總金額:NT "),t("span",bt,n(o.cartData.total),1)])])]),t("div",yt,[t("div",vt,[t("div",ft,[t("div",gt,[o.delData.title?(l(),d("h5",Dt,n(o.delData.title),1)):c("",!0),kt]),Mt,t("div",wt,[xt,t("button",{type:"button",class:"btn btn-primary",onClick:e[0]||(e[0]=s=>i.delCart(o.delData.id))},"確認移出")])])])],512),t("div",Ct,[t("div",Nt,[o.dataModalJudge?(l(),d("div",Vt,[t("div",Bt,[t("h5",Tt,[m("課程名稱: "),t("span",At,n(a.productData.product.title),1)]),It]),t("div",Ut,[t("ul",Jt,[t("li",Lt,[t("div",St,[t("div",null,"總堂數:"+n(a.productData.product.origin_price*a.productData.qty)+"堂",1),t("div",null,"授課老師: "+n(a.productData.product.unit),1)])]),t("li",Et,[t("div",null,"課程總價格:"+n(i.formatNumber(a.productData.total)),1),t("div",Rt,[m(" 購買次數: "),t("button",qt,n(a.productData.qty),1),t("ul",jt,[(l(),d(p,null,b(20,(s,h)=>t("li",{key:h},[t("a",{onClick:k=>i.changeQty(s,a.productData.id),class:"dropdown-item"},n(s),9,Ot)])),64))])])])])]),t("div",Pt,[Qt,t("button",{type:"button",class:"btn btn-primary",onClick:e[1]||(e[1]=s=>i.delCart(a.productData))},"確認移出")])])):c("",!0)])],512)])])):c("",!0),o.num===2?(l(),d("div",zt,[t("div",Ft,[t("label",Ht,[m("*姓名: "),r.姓名?(l(),d("span",Wt,n(r.姓名),1)):c("",!0)]),u(g,{id:"name",name:"姓名",type:"text",class:_(["form-control",{"is-invalid":r.姓名}]),placeholder:"請輸入 姓名",rules:"required",modelValue:o.userData.user.name,"onUpdate:modelValue":e[2]||(e[2]=s=>o.userData.user.name=s),onClick:e[3]||(e[3]=s=>i.disabledBtn())},null,8,["class","modelValue"]),u(D,{name:"姓名",class:"invalid-feedback"})]),t("div",Gt,[t("label",Kt,[m("*信箱: "),r.email?(l(),d("span",Xt,n(r.email),1)):c("",!0)]),u(g,{id:"email",name:"email",type:"email",class:_(["form-control",{"is-invalid":r.email}]),placeholder:"請輸入 Email",rules:"email|required",modelValue:o.userData.user.email,"onUpdate:modelValue":e[4]||(e[4]=s=>o.userData.user.email=s)},null,8,["class","modelValue"]),u(D,{name:"email",class:"invalid-feedback"})]),t("div",Yt,[t("label",Zt,[m("*手機號碼: "),r.電話?(l(),d("span",$t,n(r.電話),1)):c("",!0)]),u(g,{id:"phone",name:"電話",type:"tel",class:_(["form-control",{"is-invalid":r.電話}]),placeholder:"0912345678",rules:i.isPhone,modelValue:o.userData.user.phone,"onUpdate:modelValue":e[5]||(e[5]=s=>o.userData.user.phone=s)},null,8,["class","rules","modelValue"]),u(D,{name:"電話",class:"invalid-feedback"})]),t("div",te,[t("label",ee,[m("付款方式: "),r.付款方式?(l(),d("span",se,n(r.付款方式),1)):c("",!0)]),u(g,{id:"phone",name:"付款方式",type:"select",class:_(["form-control",{"is-invalid":r.付款方式}]),placeholder:"請選擇",rules:"required",modelValue:o.paymentMethod,"onUpdate:modelValue":e[7]||(e[7]=s=>o.paymentMethod=s)},{default:x(()=>[M(t("select",{class:"form-select",id:"payment","onUpdate:modelValue":e[6]||(e[6]=s=>o.paymentMethod=s)},de,512),[[V,o.paymentMethod]])]),_:2},1032,["class","modelValue"]),u(D,{name:"付款方式",class:"invalid-feedback"})]),t("div",ne,[t("label",ie,[m("*地址: "),r.地址?(l(),d("span",re,n(r.地址),1)):c("",!0)]),M(t("select",{class:"btn btn-outline-secondary",onChange:e[8]||(e[8]=(...s)=>i.city&&i.city(...s)),"onUpdate:modelValue":e[9]||(e[9]=s=>o.address.city=s)},[o.address.city?c("",!0):(l(),d("option",ce,"請選擇")),(l(!0),d(p,null,b(o.addressData,(s,h)=>(l(),d("option",{value:s.CityName,key:h},n(s.CityName),9,ue))),128))],544),[[V,o.address.city]]),M(t("select",{class:"btn btn-outline-secondary",disabled:!o.address.city,"onUpdate:modelValue":e[10]||(e[10]=s=>o.address.areaName=s)},[o.address.areaName?c("",!0):(l(),d("option",he,"請選擇")),(l(!0),d(p,null,b(o.address.areaList,(s,h)=>(l(),d("option",{value:s.AreaName,key:h},n(s.AreaName),9,_e))),128))],8,me),[[V,o.address.areaName]]),u(g,{id:"地址",name:"地址",type:"text",class:_(["form-control",{"is-invalid":r.地址}]),placeholder:"請輸入 路段 門牌號碼",rules:"required",modelValue:o.address.content,"onUpdate:modelValue":e[11]||(e[11]=s=>o.address.content=s),disabled:!o.address.areaName},null,8,["class","modelValue","disabled"]),u(D,{name:"地址",class:"invalid-feedback"})]),t("div",pe,[be,M(t("textarea",{class:"form-control","aria-label":"With textarea",placeholder:"可以說說自己，或是想告訴我們的","onUpdate:modelValue":e[12]||(e[12]=s=>o.userData.message=s)},null,512),[[A,o.userData.message]])]),t("div",ye,[ve,t("div",fe,[M(t("input",{id:"coupon",type:"text",class:"form-control",placeholder:"輸入優惠券","onUpdate:modelValue":e[13]||(e[13]=s=>o.coupon.couponNum=s),disabled:o.coupon.couponJudge},null,8,ge),[[A,o.coupon.couponNum]]),t("button",{class:"btn btn-outline-secondary",type:"button",onClick:e[14]||(e[14]=s=>i.couponBtn()),disabled:o.coupon.couponJudge},[o.coupon.couponJudge?(l(),d("span",ke,"已套用")):(l(),d("span",Me,"套用"))],8,De),o.coupon.couponJudge?(l(),d("button",{key:0,class:"btn btn-outline-secondary",type:"button",onClick:e[15]||(e[15]=s=>i.couponBtnDel())},"重設優惠券")):c("",!0)])]),t("div",we,[t("div",xe,[o.coupon.couponJudge?(l(),d("h2",Ve,[m("總金額:NT "),t("span",Be,n(i.formatNumber(o.cartData.final_total)),1)])):(l(),d("h2",Ce,[m("總金額:NT "),t("span",Ne,n(i.formatNumber(o.cartData.total)),1)]))])])])):c("",!0),t("div",Te,[o.num===2?(l(),d("button",{key:0,class:"btn btn-primary rounded-pill me-3",type:"button",onClick:e[16]||(e[16]=(...s)=>i.preBtn&&i.preBtn(...s))},"上一步")):c("",!0),o.num===1?(l(),d("button",{key:1,class:"btn btn-primary rounded-pill me-3",type:"button",onClick:e[17]||(e[17]=(...s)=>i.nextBtn&&i.nextBtn(...s))},"下一步")):c("",!0),o.num===2?(l(),d("button",{key:2,class:"btn btn-primary rounded-pill me-3 test",type:"submit",disabled:r["付款方式"]||o.disabled},"送出資料",8,Ae)):c("",!0)])]),_:1}),o.num===3?(l(),d("div",Ie,[Ue,Je,u(T,{to:"/"},{default:x(()=>[m("回到首頁")]),_:1})])):c("",!0)]),t("div",Le,[t("div",Se,[t("div",Ee,[t("div",Re,[t("h5",qe,"金額為: "+n(o.cartData.final_total),1),je]),Oe,t("div",Pe,[Qe,t("button",{type:"button",class:"btn btn-primary",onClick:e[19]||(e[19]=r=>i.pay())},"立即支付")])])])],512)])])}const Ge=J(S,[["render",ze]]);export{Ge as default};
