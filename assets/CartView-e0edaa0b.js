import{c as k}from"./cart-387cbdcb.js";import{_ as x,R as I,m as N,M,r as V,o as l,c as n,b as t,d as u,w as b,F as m,h as y,f as p,t as a,e as D}from"./index-3e55d3d1.js";import{S as v}from"./sweetalert2.all-f71783cd.js";const{VITE_URL:f,VITE_PATH:g}={VITE_PATH:"ssozr",VITE_URL:"https://vue3-course-api.hexschool.io/",BASE_URL:"/vueweek82/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},R={data(){return{cartData:[],dalModal:"",dataModal:"",dataModalJudge:!1,delData:{},delId:"",disabled:!1,productData:{}}},components:{RouterLink:I},methods:{getCartData(){this.$http.get(`${f}/v2/api/${g}/cart`).then(s=>{this.cartData=s.data.data}).catch(s=>{alert(s.data.message).error(s)})},openDelModal(s){this.deldata={},this.delModal.show(),this.delId=s.id,this.delData=s.product,console.log(this.delData)},openDelAllModal(){this.delData={},this.delId="",this.delData.title="全部商品",this.delModal.show()},openDataModal(s){this.dataModalJudge=!0,this.productData={...s},this.delId=s.id,this.dataModal.show()},delCart(){this.delId?this.$http.delete(`${f}/v2/api/${g}/cart/${this.delId}`).then(s=>{this.delData={},this.delId="",this.delModal.hide(),this.getCartData(),this.dataModal.hide(),v.fire(`${s.data.message}`),this.getCartDataPinia()}).catch(s=>{alert(s.data.message).error(s)}):this.$http.delete(`${f}/v2/api/${g}/carts`).then(s=>{this.delData={},this.delId="",this.delModal.hide(),this.getCartData(),this.getCartDataPinia(),v.fire(`${s.data.message}`)}).catch(s=>{alert(s.data.message).error(s)})},changeQty(s,i){this.disabled=!0;const w={product_id:i,qty:s};this.$http.put(`${f}/v2/api/${g}/cart/${i}`,{data:w}).then(r=>{v.fire(`${r.data.message}`),this.disabled=!1,this.getCartData(),this.dataModal.hide()}).catch(r=>{alert(r.data.message).error(r)})},formatNumber(s){if(s)return s.toLocaleString()},...N(k,["getCartDataPinia"])},mounted(){this.getCartData(),this.delModal=new M(this.$refs.delModal),this.dataModal=new M(this.$refs.dataModal)}},T={class:"container p-0","data-aos":"fade-right"},B={class:"row"},E={key:0,class:"text-center my-30"},L=t("div",{class:"d-flex justify-content-center"},[t("h2",{class:"mb-10 border-bottom border-3 border-primary"},"尚未收錄課程")],-1),S={key:1,class:"table-wrapper d-lg-block d-none"},A={class:"table align-middle"},P={class:"text-center"},j=t("th",null,"課程名稱",-1),q=t("th",null,"授課老師",-1),O=t("th",null,"總課程數",-1),J=t("th",null,"購買數量",-1),Q=t("th",null,"價格",-1),U={class:"fs-5"},F={class:"dropdown"},H=["disabled"],z={class:"dropdown-menu","aria-labelledby":"dropdownMenuButton1"},G=["onClick"],K=["onClick"],W={class:"text-center"},X=t("td",null,null,-1),Y=t("td",null,null,-1),Z=t("td",null,null,-1),$=t("td",null,null,-1),tt={class:"align-bottom"},st={class:"border-bottom border-primary border-3 mb-0"},et={class:"ms-1"},ot=t("button",{type:"button",class:"btn btn-primary fs-3"},"結帳",-1),at={key:2,class:"row d-lg-none my-15"},dt={class:""},lt={class:"fs-5"},nt={class:"d-flex align-items-center justify-content-between"},it=["onClick"],rt={class:"d-flex justify-content-between"},ct={class:"border-bottom border-primary border-3 mb-0 fs-4"},_t={class:"ms-1"},ht=t("button",{type:"button",class:"btn btn-primary fs-5"},"結帳",-1),ut=t("div",null,null,-1),bt={class:"modal",tabindex:"-1",ref:"delModal"},pt={class:"modal-dialog"},mt={class:"modal-content"},yt={class:"modal-header"},ft={key:0,class:"modal-title"},gt=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),Dt=t("div",{class:"modal-body"},[t("p",null,"確定移出此課程?")],-1),vt={class:"modal-footer"},wt=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"取消",-1),Mt={class:"modal",tabindex:"-1",ref:"dataModal"},Ct={class:"modal-dialog"},kt={key:0,class:"modal-content"},xt={class:"modal-header"},It={class:"modal-title"},Nt={class:"border-bottom border-3 border-primary"},Vt=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),Rt={class:"modal-body"},Tt={class:"p-0"},Bt={class:"mb-3"},Et={class:"d-flex align-items-center justify-content-between"},Lt={class:"d-flex align-items-center justify-content-between"},St={class:"dropdown"},At=["disabled"],Pt={class:"dropdown-menu","aria-labelledby":"dropdownMenuButton1"},jt=["onClick"],qt={class:"modal-footer"},Ot=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"取消",-1);function Jt(s,i,w,r,e,d){const c=V("RouterLink");return l(),n("div",T,[t("div",B,[e.cartData.total===0?(l(),n("div",E,[L,u(c,{to:"teachers",class:"btn btn-primary"},{default:b(()=>[p("立即前往課程列表")]),_:1})])):(l(),n("div",S,[t("table",A,[t("thead",null,[t("tr",P,[j,q,O,J,Q,t("th",null,[t("button",{type:"button",class:"btn btn-primary rounded-pill",onClick:i[0]||(i[0]=o=>d.openDelAllModal())},"清空購物車")])])]),t("tbody",null,[(l(!0),n(m,null,y(e.cartData.carts,(o,_)=>(l(),n("tr",{key:_,class:"text-center"},[t("td",null,[u(c,{to:`/class/${o.product.id}`},{default:b(()=>[t("h2",U,a(o.product.title),1)]),_:2},1032,["to"])]),t("td",null,a(o.product.unit),1),t("td",null,a(o.product.origin_price*o.qty)+"堂",1),t("td",null,[t("div",F,[t("button",{disabled:e.disabled,class:"btn btn-secondary dropdown-toggle",type:"button",id:"dropdownMenuButton1","data-bs-toggle":"dropdown","aria-expanded":"false"},a(o.qty),9,H),t("ul",z,[(l(),n(m,null,y(20,(h,C)=>t("li",{key:C},[t("a",{onClick:Qt=>d.changeQty(h,o.id),class:"dropdown-item"},a(h),9,G)])),64))])])]),t("td",null,a(d.formatNumber(o.total)),1),t("td",null,[t("button",{type:"button",class:"btn btn-primary rounded-pill",onClick:h=>d.openDelModal(o)},"刪除",8,K)])]))),128)),t("tr",W,[X,Y,Z,$,t("td",tt,[t("h2",st,[p("總金額:NT "),t("span",et,a(d.formatNumber(e.cartData.total)),1)])]),t("td",null,[u(c,{to:"/Order"},{default:b(()=>[ot]),_:1})])])])])])),e.cartData.total!==0?(l(),n("div",at,[(l(!0),n(m,null,y(e.cartData.carts,(o,_)=>(l(),n("ul",{key:_,class:"border-bottom pb-3 border-primary"},[t("li",dt,[u(c,{to:`/class/${o.product.id}`},{default:b(()=>[t("h2",lt,a(o.product.title),1)]),_:2},1032,["to"]),t("div",nt,[t("div",null,"課程總價格:"+a(d.formatNumber(o.total)),1),t("button",{type:"button",class:"btn btn-primary",onClick:h=>d.openDataModal(o)},"詳細資料",8,it)])])]))),128)),t("div",rt,[t("h2",ct,[p(" 總金額:NT "),t("span",_t,a(d.formatNumber(e.cartData.total)),1)]),u(c,{to:"/Order"},{default:b(()=>[ht]),_:1})])])):D("",!0),ut]),t("div",bt,[t("div",pt,[t("div",mt,[t("div",yt,[e.delData.title?(l(),n("h5",ft,a(e.delData.title),1)):D("",!0),gt]),Dt,t("div",vt,[wt,t("button",{type:"button",class:"btn btn-primary",onClick:i[1]||(i[1]=o=>d.delCart(e.delData.id))},"確認移出")])])])],512),t("div",Mt,[t("div",Ct,[e.dataModalJudge?(l(),n("div",kt,[t("div",xt,[t("h5",It,[p("課程名稱: "),t("span",Nt,a(e.productData.product.title),1)]),Vt]),t("div",Rt,[t("ul",Tt,[t("li",Bt,[t("div",Et,[t("div",null,"總堂數:"+a(e.productData.product.origin_price*e.productData.qty)+"堂",1),t("div",null,"授課老師: "+a(e.productData.product.unit),1)])]),t("li",Lt,[t("div",null,"課程總價格:"+a(d.formatNumber(e.productData.total)),1),t("div",St,[p(" 購買次數: "),t("button",{disabled:e.disabled,class:"btn btn-secondary dropdown-toggle",type:"button",id:"dropdownMenuButton1","data-bs-toggle":"dropdown","aria-expanded":"false"},a(e.productData.qty),9,At),t("ul",Pt,[(l(),n(m,null,y(20,(o,_)=>t("li",{key:_},[t("a",{onClick:h=>d.changeQty(o,e.productData.id),class:"dropdown-item"},a(o),9,jt)])),64))])])])])]),t("div",qt,[Ot,t("button",{type:"button",class:"btn btn-primary",onClick:i[2]||(i[2]=o=>d.delCart(e.productData))},"確認移出")])])):D("",!0)])],512)])}const zt=x(R,[["render",Jt]]);export{zt as default};
